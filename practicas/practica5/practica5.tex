% [Tamaño principal de la fuente del documento, tamaño del papel, con título (crea salto de página)]{Tipo de documento}
\documentclass[12pt, a4paper, titlepage]{article}
\usepackage[utf8]{inputenc}
% Traduce expresiones al español
\usepackage[spanish]{babel}
\usepackage{setspace}

\usepackage{graphicx}
\usepackage{geometry}
\geometry{margin=2.5cm}
\graphicspath{ {./capturas/} }

% Permite utilizar labeling para listar de forma personalizada
\usepackage{scrextend}
% Permite centrar verticalmente m{}
\usepackage{array}
% Permite colorear texto
\usepackage{xcolor}
\usepackage[dvipsnames]{xcolor}

\title{\LARGE \textbf{Práctica 5: Módulos Odoo Controlador, Herencia y Web Controllers.} \\[2ex] \Large Sistemas de Gestión Empresarial}
\author{\\[20ex]Cristian Fernández}
\date{\today}

\begin{document}
\maketitle

\doublespacing
\noindent \\
\tableofcontents % Índice

\newpage

\section{Introducción}
\noindent \\El objetivo de esta práctica es aplicar los conocimientos adquiridos sobre vistas, wizards, informes y 
controladores web. Para ello, nos ocuparemos de la implementación de cuatro actividades que abarcan diferentes contextos:

\begin{itemize}
    \item \textbf{EJ07-LigaFutbol}\textcolor{RoyalBlue}{\hspace{1em}\textit{4 puntos}}
    \begin{itemize}
        \item Se modificará el módulo para que incluya las siguientes funcionalidades:
        \begin{itemize}
            \item Reglas de puntuación especiales.\textcolor{Turquoise}{\hspace{1em}\textit{1 punto}}
            \item Botones para alterar los goles de los partidos.\textcolor{Turquoise}{\hspace{1em}\textit{1 punto}}
            \item Web controller para eliminar empates.\textcolor{Turquoise}{\hspace{1em}\textit{0,5 punto}}
            \item Informe PDF por cada partido.\textcolor{Turquoise}{\hspace{1em}\textit{0,5 punto}}
            \item Wizard para crear nuevos partidos.\textcolor{Turquoise}{\hspace{1em}\textit{0,5 punto}}
            \item Vista Graph.\textcolor{Turquoise}{\hspace{1em}\textit{0,5 punto}}
        \end{itemize}
    \end{itemize}
    \item \textbf{EJ08-API-REST\_Socios}\textcolor{RoyalBlue}{\hspace{1em}\textit{1,5 puntos}}
    \begin{itemize}
        \item Se grabará un vídeo explicativo realizando operaciones CRUD.
    \end{itemize}
    \item \textbf{Bot de Telegram}\textcolor{RoyalBlue}{\hspace{1em}\textit{3 puntos}}
    \begin{itemize}
        \item Se creará un bot de Telegram que escuchará ordenes enviadas por los usuarios.
    \end{itemize}
    \item \textbf{Generación de imágenes aleatorias con Web Controller}\textcolor{RoyalBlue}{\hspace{1em}\textit{1,5 puntos}}
    \begin{itemize}
        \item Se creará un \textit{Web Controller} que reciba parámetros, genere una imagen de píxeles aleatorios y la
        devuelva en Base64 o PNG.
    \end{itemize}
\end{itemize}

\noindent \\Los ejemplos citados anteriormente se encuentran en el siguiente repositorio.\\
\textit{https://github.com/sergarb1/OdooModulosEjemplos} \\
\newpage

\section{Actividad 01 – Modificación \textit{EJ07-LigaFutbol}}
\subsection{Reglas de puntuación especiales}
\noindent \\Se solicita modificar la lógica de puntuación de los partidos para que, en un partido con 4 o más goles de diferencia, el
ganador se lleve 7 puntos y al perdedor se le reste 1.\\\\
Antes de comenzar será necesario modificar el código de las vistas para que el módulo se pueda instalar correctamente en Odoo.
Deberemos sustituir las etiquetas \textless tree\textgreater por \textless list\textgreater tal como se ve en la siguiente imagen:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{01.png}
    \caption{Aplicar estos cambios en las 3 vistas}
\end{figure}
\newpage
\noindent \\Una vez instalado el módulo accedemos a él y vemos lo siguiente:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.7\textwidth]{02.png}
    \caption{Las 4 vistas del módulo}
\end{figure}
\noindent \\\\Tras añadir los 10 primeros equipos de la primera división española nos quedará así:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.7\textwidth]{03.png}
\end{figure}
\newpage
\noindent \\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.7\textwidth]{04.png}
    \caption{Podemos simular varios partidos de prueba...}
\end{figure}
\noindent \\\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.9\textwidth]{05.png}
    \caption{Para ver la puntuación genérica en la clasificación general}
\end{figure}
\newpage
\noindent \\Ahora echémosle un vistazo al código del módulo. Básicamente nos encontramos con 2 modelos, \textit{liga\_partido.py} y \textit{liga\_equipo.py}.
En este último se calcula la puntuación con un campo computado llamado puntos tal como se ve en la siguiente imagen:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{06.png}
\end{figure}
\noindent \\Dada la lógica que queremos implementar para la puntuación vamos a convertir ese campo computado en uno normal, tal que así:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{07.png}
\end{figure}
\noindent \\Cambiamos de modelo y nos vamos a \textit{liga\_partido.py} y añadimos el campo creado en el paso anterior dentro de la función
\textit{actualizoRegistrosEquipo()}:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{08.png}
\end{figure}
\newpage
\noindent \\En la misma función deberemos modificar todo este código...\\\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{09.png}
    \caption{Código original...}
\end{figure}
\noindent \\\\\\Por este otro en el que añadiremos la nueva lógica de puntuación, tal como se muestran en las capturas de la página siguiente:
\newpage
\noindent \\\\\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{10.png}
    \caption{Código para equipo local}
\end{figure}
\newpage
\noindent \\\\\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{11.png}
    \caption{Código para equipo visitante}
\end{figure}
\noindent \\\\\\Es necesario matizar que, según esta lógica, cuando un partido se resuelve con una diferencia de goles igual o superior a 4,
el equipo perdedor recibirá una puntuación negativa de -1. \underline{Esto quiere decir que puede terminar la temporada con puntuación negativa.}\\\\
Ahora echemos un vistazo al módulo de Odoo para ver si se han efectuado correctamente las modificaciones. Sobra decir que es
necesario reiniciar el contenedor para que se apliquen los cambios.
\newpage
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{12.png}
    \caption{Crearemos nuevos partidos de prueba}
\end{figure}
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{13.png}
    \caption{Comprobamos que el sistema de puntuación se aplica correctamente}
\end{figure}
\newpage

\subsection{Botones para alterar los goles de los partidos}
\noindent \\Se nos pide modificar la vista de los partidos para añadir 2 nuevos botones:
\begin{itemize}
        \item \textbf{Botón ``+2 goles equipos locales''} Sumará 2 goles a todos los equipos locales.
        \item \textbf{Botón ``+2 goles equipos visitantes''} Sumará 2 goles a todos los equipos visitantes.
\end{itemize}
Tras cada acción la clasificación deberá actualizarse.\\\\
Lo primero que haremos será añadir 2 funciones de actualización en el modelo correspondiente (\textit{liga\_partido.py}) que posteriormente
asignaremos a los botones de la vista.
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.8\textwidth]{14.png}
    \caption{Recorremos array, aplicamos +2 a la propiedad correspondiente y actualizamos}
\end{figure}
\newpage
\noindent \\Ahora toca modificar la vista \textit{liga\_partido.xml} para añadir los nuevos botones. En esta vista hay 2 formas de visualizar
los datos, una en modo Lista y la otra en modo Kanban (la que está por defecto). Para hacer correctamente la implementación solicitada deberemos
añadir la nueva botonera en la cabecera de ambas etiquetas, \underline{forzando su visualización} (si no la forzamos deberemos seleccionar 
obligatoriamene algún partido para que se visualicen los botones), tal como se ve en las siguientes capturas:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.9\textwidth]{15.png}
\end{figure}
\noindent \\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.9\textwidth]{16.png}
\end{figure}
\newpage
\noindent \\Llegados a este punto sólo nos falta comprobar que los cambios se han realizado correctamente. Visualicemos el módulo de Odoo para 
comprobarlo.\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.9\textwidth]{17.png}
    \caption{Vista Kanban (por defecto)}
\end{figure}
\noindent \\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.9\textwidth]{18.png}
    \caption{Vista Lista}
\end{figure}
\newpage
\noindent \\Probemos la funcionalidad de los botones:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.9\textwidth]{19.png}
    \caption{Añadimos 2 goles a todos los equipos locales en Vista Kanban}
\end{figure}
\noindent \\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.9\textwidth]{20.png}
    \caption{El resultado es satisfactorio}
\end{figure}
\newpage
\noindent \\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.9\textwidth]{21.png}
    \caption{Añadimos 2 goles a todos los equipos locales en Vista Lista}
\end{figure}
\noindent \\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.9\textwidth]{22.png}
    \caption{El resultado es satisfactorio}
\end{figure}
\newpage
\noindent \\Por último, vayamos a la Vista de Clasificación para comprobar que los datos se han actualizado correctamente.\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.9\textwidth]{23.png}
    \caption{Actualización realizada satisfactoriamente}
\end{figure}
\newpage

\subsection{Web Controller para eliminar empates}
\noindent \\Se nos solicita crear un Web Controller que elimine todos los partidos que hayan terminado en empate y que devuelva el número
de partidos eliminados. La url designada para dicha petición será \textit{http://localhost:\textbf{puerto}/eliminarempates} (en este caso,
debido a la configuración de Docker, \underline{el puerto será el 9001}).\\
\noindent \\Lo primero que haremos será echar un vistazo a la clase \textit{main.py} ubicada en la carpeta \textit{controllers}. Aquí crearemos 
una nueva función en la que, al acceder a la url requerida, efectuará la lógica solicitada. Veamos el código:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.9\textwidth]{24.png}
    \caption{Web Controller por defecto}
\end{figure}
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{25.png}
    \caption{Comprobamos que efectivamente funciona}
\end{figure}
\newpage
\noindent \\Creamos la nueva función solicitada, quedaría tal como se muestra en la siguiente captura:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{26.png}
\end{figure}
\noindent \\\\Haremos una prueba que nos debería devolver un resultado negativo ya que nos tenemos almacenados partidos con empate:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{27.png}
    \caption{Este resultado es correcto}
\end{figure}
\newpage
\noindent \\Como queremos comprobar un resultado positivo crearemos unos empates y volveremos a hacer la petición, tal como se muestra
en las siguientes imágenes:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{28.png}
    \caption{Creamos 2 empates de prueba}
\end{figure}
\noindent \\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{29.png}
    \caption{Ahora el resultado es el correcto tras la eliminación de empates}
\end{figure}
\newpage
\noindent \\Finalmente vamos a comprobar la clasificación para verificar que las puntuaciones se han actualizado correctamente tras
los borrados:\\\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{30.png}
    \caption{Puntuaciones actualizadas satisfactoriamente}
\end{figure}
\noindent \\\\No hay duda... este Web Controller funciona a las mil maravillas.
\newpage

\subsection{Informe PDF por cada partido}
\noindent \\Se nos pide generar un informe PDF que muestre los datos de un partido. Para ello crearemos una plantilla visual dentro de la 
carpeta \textit{report} (que está relacionada con la generación de documentos impresos) y un botón dentro de la vista de partidos para que
el usuario pueda generar el documento.\\\\
Echémosle un vistazo a la plantilla que ya está creada:
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{31.png}
\end{figure}
\newpage
\noindent \\Basándonos en esa plantilla crearemos una nueva desde cero que cumpla con los requisitos solicitados. La llamaremos 
\textit{liga\_partido\_report.xml} y la ubicaremos dentro de la carpeta \textit{report}. Será necesario enlazarla dentro del 
archivo \textit{\_\_manifest\_\_.py} del proyecto, tal como se muestra en la siguiente captura:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{32.png}
\end{figure}
\noindent \\La creación de la plantilla es problemática ya que \textbf{Odoo 18} y la librería \textbf{wkhtmltopdf}, ya que
existen ciertas incompatibilidades. Odoo 18 usa Bootstrap 5, que basa casi todo su diseño en Flexbox y CSS Grid. Sin embargo, wkhtmltopdf
(el motor que genera el PDF) utiliza un motor de renderizado basado en una versión muy antigua de WebKit (similar a un navegador de hace 10 años).
Por las dificultades de crear una plantilla decente me he visto obligado a generar gran parte de la parte visual con asistencia de la IA.\\
Veamos por partes cómo ha quedado el código de la plantilla en las siguientes capturas:
\newpage
\noindent \\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{33.png}
    \caption{La acción (orden de generar informe) e inicio de la plantilla}
\end{figure}
\noindent \\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{34.png}
    \caption{Esta parte mostrará los equipos y el resultado}
\end{figure}
\newpage
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{35.png}
    \caption{Esta parte mostrará los detalles del partido}
\end{figure}
\noindent \\Por último falta añadir el botón en la vista \textit{liga\_partido.xml} tal como se ve en la siguiente captura:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{36.png}
    \caption{Esta será nuestro botón, se llamará \textit{``Generar PDF"}}
\end{figure}
\noindent \\Sólo nos falta comprobar si funciona. Cabe recordar que \underline{será necesario reiniciar el contenedor}
y \underline{actualizar el módulo desde Odoo}. Veamos los resultados en las siguientes capturas:
\newpage
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.8\textwidth]{37.png}
    \caption{Clicamos en un partido}
\end{figure}
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.8\textwidth]{38.png}
    \caption{Clicamos en el nuevo botón}
\end{figure}
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.9\textwidth]{39.png}
    \caption{Tras unos segundos se generará el siguiente archivo PDF}
\end{figure}
\newpage
\noindent \\Si quisiésemos imprimir todos los partidos en un único archivo deberemos cargar la vista Lista, seleccionar todos los partidos y darle a imprimir.\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.9\textwidth]{40.png}
\end{figure}
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{41.png}
    \caption{¿El resultado? Un PDF con todos los partidos}
\end{figure}
\noindent \\\\Es un quebradero de cabeza muy elevado crear una plantilla decente si no se tienen en cuenta todas las dificultades existentes
actualmente entre Odoo y la herramienta externa \textit{wkhtmltopdf}.
\newpage

\subsection{Wizard para crear nuevos partidos}
\noindent \\Se solicita crear un Wizard que permita introducir equipo local, equipo visitante, goles y un nuevo campo jornada. Obviamente
esto generará un nuevo registro en la tabla liga\_partido de la base de datos. Para crear correctamente el Wizard tendremos que crear un
modelo y una vista, enlazarlos en el archivo \textit{\_\_init\_\_.py} ubicado en la carpeta \textit{wizard} del proyecto y en el
\textit{\_\_manifest\_\_.py} en la raíz del proyecto respectivamente, y sin olvidarnos de proporcionar permisos al nuevo modelo creado
en el archivo \textit{ir.model.access.csv}.\\
\noindent \\Empecemos por lo más tedioso. Primero crearemos el modelo y la vista únicamente con el esqueleto dentro de la carpeta wizard.
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{46.png}
\end{figure}
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{47.png}
\end{figure}
\noindent \\\\En las siguiente página los enlaces:
\newpage
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{48.png}
\end{figure}
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{49.png}
\end{figure}
\noindent Por último los permisos:
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{50.png}
\end{figure}
\newpage
\noindent Configuración inicial del Wizard completada. Tras comprobar que la pestaña ``Añadir partido'' aparece en nuestro módulo de Odoo podemos
empezar a escribir el código del modelo.\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{51.png}
\end{figure}
\noindent \\Es importante que el nombre de los campos de este Wizard coincidan con los nombres de los campos del modelo original, en este caso
\textit{liga\_partido.py}, en el que tendremos que añadir el nuevo campo jornada.\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.6\textwidth]{52.png}
\end{figure}
\newpage
\noindent Ahora echemos un vistazo a cómo debe quedar la vista:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{53.png}
\end{figure}
\noindent \\Tenemos todo lo necesario para hacer pruebas. Como bien sabemos, toca reiniciar contenedores y actualizar módulos dentro de
Odoo.\\\\
En las siguientes capturas observaremos el Wizard en funcionamiento:
\newpage
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.8\textwidth]{54.png}
\end{figure}
\noindent \\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.8\textwidth]{55.png}
\end{figure}
\newpage
\subsection{Vista Graph}
\noindent \\Se nos solicita implementar una vista gráfica en la vista partidos que muestre estadísticas de los goles marcados por los equipos
locales. Basándonos en el Graph que ya está creado en la vista \textit{liga\_equipo.xml}, vamos a adaptarlo en la vista \textit{liga\_partido.xml}.\\
Veamos cómo queda el nuevo código añadido:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.9\textwidth]{56.png}
    \caption{Recordad añadir \underline{graph} en el \textit{view\_mode}}
\end{figure}
\noindent \\Comprobremos si funciona:\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.9\textwidth]{57.png}
    \caption{Aparece la nueva vista Graph, clicamos en ella}
\end{figure}
\newpage
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.7\textwidth]{58.png}
\end{figure}
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.7\textwidth]{59.png}
\end{figure}
\newpage
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{60.png}
\end{figure}
\noindent \\Como hemos podido apreciar en las capturas anteriores, los distintos modos de mostrar los datos (gráfica de barras, gráfica de 
líneas y gráfica circular) funcionan correctamente.\\\\
La implementación de la vista gráfica en la vista de partidos ha sido satisfactoria.
\newpage

\section{Actividad 02 – Pruebas \textit{EJ08-API-REST\_Socio}}
\noindent \\Para la realización de esta actividad he empleado las siguientes herramientas:\\
\begin{itemize}
    \item \textit{\textbf{Kdenlive:}} es un potente editor de video no lineal, libre y de código abierto, basado en el framework MLT. 
    Funciona en Linux, Windows y macOS, permitiendo la edición multipista de audio y video con múltiples efectos, transiciones y 
    herramientas de corrección de color, ideal tanto para usuarios principiantes como profesionales.
\end{itemize}
\begin{itemize}
    \item \textit{\textbf{Luvvoice:}} es una plataforma de inteligencia artificial diseñada para convertir texto en voz (Text-to-Speech) de forma
    realista y natural. Es una herramienta muy utilizada por creadores de contenido para narrar videos de YouTube o TikTok, así como
    por educadores para crear audiolibros o material didáctico.
\end{itemize}
\noindent \\El vídeo creado se divide en dos partes bien diferenciadas. En la primera parte se muestra el código de la API donde se puede
apreciar la url en la que realizar las peticiones y el formato en el que deben enviarse los datos. En la segunda parte se muestran las peticiones
http (POST, GET, PUT y DELETE) hechas con el programa \textit{\textbf{Postman}}. \\\\
La duración del vídeo no debe exceder de los 3 minutos (en este caso dura aproximadamente 2 minutos y medio). \\\\
El archivo \textit{Actividad 2.mp4} está ubicado en la carpeta \textit{practica5} del proyecto.
\newpage

\section{Actividad 03 – Bot Telegram API REST}
\noindent \\Se nos solicita crear un bot de Telegram (configurado con BotFather) que escuche ordenes enviadas por el usuario que apunten a la 
API REST del módulo ``EJ08-API-REST-Socios''.\\\\
Las órdenes que debe soportar el bot serán:
\begin{itemize}
    \item \textbf{Crear}, nombre=``nombre", apellidos=``apellidos", num\_socio=``numerosocio''
    \item \textbf{Modificar}, nombre=``nombre'', apellidos=``apellidos'', num\_socio=``numerosocio''
    \item \textbf{Consultar}, num\_socio=``numerosocio''
    \item \textbf{Borrar}, num\_socio=``numerosocio''
\end{itemize}
\noindent \\Si no recibe ninguna de las órdenes anteriores deberá devolver la respuesta ``Orden no soportada''.
Lo primero que haremos será descargarnos las librerías necesarias en la máquina real.
\newpage

\section{Actividad 04 – Generación imágenes aleatorias Web Controller}
\noindent \\Se nos pide crear un Web Controller que:
\begin{itemize}
    \item Utilice la librería \textbf{Pillow}
    \item Reciba como parámetros el ancho y alto de una imagen.
    \item Genere una imagen compuesta por píxeles aleatorios.
    \item Devuelva la imagen codificada en Base64 o directamente como binario PNG.
    \item Se recomienda ojear el módulo ``\textit{EJ09-GenerarBarcode}"
\end{itemize}
\noindent \\Tal como nos recomienda el enunciado vamos a ojear el archivo \textit{generarbarcode.py} dentro de la carpeta
\textit{controllers} del módulo \textit{EJ09-GenerarBarcode}:
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{42.png}
\end{figure}
\noindent \\Podemos ver en la ``preparación del entorno" la importación de 2 herramientas clave: \textbf{BytesIO} y \textbf{base64}.
La primera permite almacenar un archivo en la memoria RAM de forma temporal en vez de en el disco duro del servidor, evitando una posible
saturación en el supuesto de que cientos o miles de usuarios intenten generar dicho archivo al mismo tiempo. La segunda se encarga de traducir
los datos binarios de un archivo y convertirlos a una cadena de caracteres seguros, lo cual beneficia su procesado en el lenguaje HTML.
\newpage
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{43.png}
\end{figure}
\noindent \\El código de esta función es bastante autoexplicativo. Primero genera un código de barras, luego lo almacena en un buffer
temporal, después transforma todo el binario a texto y finalmente lo muestra en formato HTML. \\
\noindent \\Tomando este código como inspiración vamos a crear un nuevo Web Controller que haga exactamente lo mismo, solo que en vez de 
generar un código de barras generará la imagen de píxeles aleatorios que nos han solicitado. Por gusto crearé el controlador dentro del 
módulo \textit{EJ07-LigaFutbol} (ya que ha sido el más utilizado en toda esta práctica) dentro de su respectiva carpeta \textit{controllers}
(\underline{importante referenciarlo en su respectivo \_\_init\_\_.py}).\\
El nuevo archivo se llamará \textit{imagen\_aleatoria.py}.
\newpage
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=1\textwidth]{44.png}
\end{figure}
\noindent \\De forma muy similar al código de ejemplo anterior, importamos las librerías necesarias (en este caso la librerías clave son
base64, BytesIO y especialmente Pillow) y creamos una función (Web Controller) que genere una imagen, la llene de píxeles aleatorios, la 
almacene temporalmente en RAM, la traduzca a cadena de caracteres y la muestre por pantalla en la ruta especificada, que en este caso sería
\textit{http://localhost:9001/imagen/`ancho'/`alto'}, siendo `ancho' y `alto' 2 números enteros.
\newpage
\noindent \\A continuación una muestra del funcionamiento del Web Controller. Le diremos al controlador que nos devuelva una imagen de 
500 píxeles de ancho y 500 píxeles de alto generada con píxeles de colores aleatorios.\\
\begin{figure}[hbt!]
    \centering
    \includegraphics[width=0.9\textwidth]{45.png}
\end{figure}
\newpage

\end{document}